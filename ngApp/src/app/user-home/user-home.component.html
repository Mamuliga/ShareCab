<div class="tab">
  <div class="container-fluid">
    <h1 class="text-center">Make your Ride Now!</h1>
    <div class="row">
      <div class="col-md-8">
        <!--
          <div [hidden]="autocompleteItems.length == 0">
            <div
              *ngFor="let item of autocompleteItems"
              tappable
              (click)="selectSearchResult(item)"
            >
              {{ item.description }}
            </div>
          </div>
          Total Distance: <span id="total"></span>
          <div #map id="map"></div>
        -->
        <!--
          <button
            id="distance"
            (click)="calculateDistance()"
            type="button"
            class="btn btn-primary float-right"
          >
            Display distance
          </button>

          <button
            id="point"
            (click)="calculateDuration()"
            type="button"
            class="btn btn-primary float-right"
          >
            Display duration
          </button>
        -->

        <!-- smartphone -->

        <!-- tablet -->

        <!-- <div class="tablet-portrait"> -->

        <!--
          </div>
          <div class="form-group">
            <input placeholder="search for Destination" autocorrect="off" autocapitalize="off" spellcheck="off" type="text"
              class="form-control" #search [formControl]="searchControl">


          </div>
        -->
        <div class="form-group">
          <input
            placeholder="search for Destination"
            autocorrect="off"
            autocapitalize="off"
            spellcheck="off"
            type="text"
            class="form-control"
            #search
            [formControl]="searchControl"
          />

          <agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom">
            <agm-direction
              *ngIf="destination.lat !== null"
              [origin]="{ lat: this.lat, lng: this.lng }"
              [destination]="{
                lat: this.destination.lat,
                lng: this.destination.lng
              }"
            >
            </agm-direction>

            <agm-direction
              *ngFor="let r of myRides.riders"
              [origin]="r.origin"
              [destination]="r.destination"
            >
            </agm-direction>

            <agm-marker
              *ngIf="destination.lat === null"
              [latitude]="lat"
              [longitude]="lng"
              iconUrl="images/as.png"
            ></agm-marker>

            <agm-marker
              *ngFor="let d of drivers"
              [latitude]="d.origin.lat"
              [longitude]="d.origin.lng"
            ></agm-marker>
          </agm-map>
        </div>
      </div>
      <div class="col-md-4" *ngIf="destination.lat">
        <div *ngIf ="showConfirmedBtn" >
        <button (click)="confirmRides(true)" class = "btn btn-primary btn-block">Confirm</button>
        <button (click)="confirmRides(false)" class = "btn btn-danger btn-block">Cancel</button>
        </div>
        <p *ngIf="myRides.isConfirmed!==undefined && !myRides.isConfirmed" >Your Request is pending...</p>
        <p *ngIf="myRides.isConfirmed!==undefined && myRides.isConfirmed" >Your Journey Start From Now</p>
        <div class="btn-group" *ngIf="!loading && drivers.length !== 0">
          <button class="btn btn-primary" (click)="getDetails(false)">
            Request Shared Ride
          </button>
          <button class="btn btn-primary" (click)="getDetails(true)">
            Request Private Ride
          </button>
        </div>
        <h5 *ngIf="drivers.length === 0" class="text-danger">
          Drivers Are Not Available At the Moment :(
        </h5>
        <div
          [hidden]="!showDetails"
          class="bg-primary text-light p-3"
          id="details-banner"
        >
          <p id="duration"></p>
          <p id="distance"></p>
        </div>

        <table class="table" *ngIf="myRides.riders.length !== 0">
          <tr>
            <th>Name</th>
            <th>Contact</th>
            <th>Price</th>
          </tr>
          <tr></tr>
          <tr *ngFor="let r of myRides.riders">
            <td>{{ r.userDetails.name }}</td>
            <td>{{ r.userDetails.contact }}</td>
            <td>{{ r.userDetails.price }}</td>
          </tr>
        </table>

        <table class="table" *ngIf="drivers.length !== 0">
          <tr>
            <th>Name</th>
            <th>Contact</th>
            <th></th>
          </tr>
          <tr></tr>
          <tr *ngFor="let d of drivers">
            <td>{{ d.name }}</td>
            <td>{{ d.contact }}</td>
            <td>
              <button
                class="btn"
                ngClass="{'btn-success':d.isSelected}"
                [disabled]="d.isSelected"
                (click)="driverSelect(d._id)"
              >
                {{ d.isSelected ? "Selected" : "Not Selected" }}
              </button>
            </td>
          </tr>
        </table>

        <button
          (click)="onPromoClick()"
          class="btn btn-success"
          *ngIf="isPromo"
        >
          Get Promotions
        </button>
        <span *ngIf="price" class="badge badge-success">
          new price {{ price }}</span
        >

        <ul>
          <li class="text" *ngFor="let item of (items | async)">
            {{ item.name }}
          </li>
        </ul>

        <button (click)="deleteRide()" class="btn btn-success">
          Cancel Ride
        </button>
      </div>
    </div>

    <!-- <div *ngFor="let message of messages">{{ message }}</div>

    <input [(ngModel)]="message" />
    <button (click)="sendMessage()">Send</button> -->
    <!-- </div> -->
  </div>
</div>
